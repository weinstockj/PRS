using Test
using PRSFNN: joint_log_prob, rss, elbo
using Distributions: Normal

@testset "tests" begin
    
    @test rss(
        [0.0011, .0052, 0.0013],
        [-0.019, 0.013, -.0199],
        [.0098, .0098, .0102],
        [1.0 .03 .017; .031 1.0 -0.03; .017 -0.02 1.0]
    ) == 6.551876500157087

    @test abs(joint_log_prob(
        [0.0011, .0052, 0.0013],
        [-0.019, 0.013, -.0199],
        [.0098, .0098, .0102],
        [1.0 .03 .017; .031 1.0 -0.03; .017 -0.02 1.0],
        0.01,
        0.10
       ) - 15.95427) < .0001

    # @test abs(elbo(
    #     rand(Normal(0, 1), 3),
    #     [0.01, -0.003, 0.0018],
    #     [-9.234, -9.24, -9.24],
    #     [0.023, -0.0009, -.0018],
    #     [.0094, .00988, .0102],
    #     [1.0 .03 .017; .031 1.0 -0.03; .017 -0.02 1.0],
    #     0.01,
    #     0.10
    #    ) - -5.10) < 0.1
end
